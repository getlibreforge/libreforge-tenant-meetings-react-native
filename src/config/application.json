{
  "home": {
    "root": {
      "id": "root",
      "parent": "root",
      "type": "Box",
      "children": [
        "2ddb9c63-18dc-411c-82f2-46bac51c2ddc"
      ],
      "props": {},
      "rules": {},
      "actionGroup": {}
    },
    "2ddb9c63-18dc-411c-82f2-46bac51c2ddc": {
      "id": "2ddb9c63-18dc-411c-82f2-46bac51c2ddc",
      "props": {
        "_x_name": "2ddb9c63-18dc-411c-82f2-46bac51c2ddc",
        "isJustOnce": true
      },
      "children": [],
      "type": "Automatic Action",
      "parent": "4e338353-8e69-4396-85ec-c153af7b4884",
      "rootParentType": "Automatic Action",
      "rules": {},
      "actionGroup": {
        "0": {
          "action": "ExecuteScript",
          "params": {
            "script": "const apiKey = await ctx.getExt(\"SecureStorage\").read(\"apiKey\"); const calendarId = await ctx.getExt(\"SecureStorage\").read(\"calendarId\"); if (!apiKey || !calendarId) { ctx.getRouter().navigate(\"settings\"); } else { ctx.getRouter().navigate(\"dashboard\"); } "
          }
        }
      }
    }    
  },
  "settings": {
    "root": {
      "id": "root",
      "parent": "root",
      "type": "Box",
      "children": [   
        "61e5b71f-8f10-413f-9d45-e19cc22c57f3",
        "d48ef28b-380a-4c38-a77c-38e2621b5237",
        "65e17411-c15c-48f1-b1c5-dff402b23d11",
        "39ca73f9-b84a-4082-98fe-2b5c1e17c1ac",
        "e76c3300-2c9e-4939-8737-2ec6f28134bc",
        "825079e6-3703-4a91-b1a6-d611006e149e"        
      ],
      "props": {},
      "rules": {},
      "actionGroup": {}
    },
    "825079e6-3703-4a91-b1a6-d611006e149e": {
      "id": "825079e6-3703-4a91-b1a6-d611006e149e",
      "props": {
        "_x_name": "825079e6-3703-4a91-b1a6-d611006e149e",
        "children": "Back",
        "variant": "solid",
        "size": "md",
        "colorScheme": "messenger",
        "backgroundColor": "black"
      },
      "children": [],
      "type": "Button",
      "parent": "root",
      "rootParentType": "Button",
      "rules": {},
      "actionGroup": {
        "0": {
          "action": "RNRouteToPage",
          "params": {
            "url": "/dashboard"
          }
        }
      }
    },    
    "e76c3300-2c9e-4939-8737-2ec6f28134bc": {
      "id": "e76c3300-2c9e-4939-8737-2ec6f28134bc",
      "props": {
        "_x_name": "e76c3300-2c9e-4939-8737-2ec6f28134bc",
        "children": "Save",
        "variant": "solid",
        "size": "md",
        "backgroundColor": "green",
        "color": "white",
        "w": "50%"
      },
      "children": [],
      "type": "Button",
      "parent": "root",
      "rootParentType": "Button",
      "rules": {},
      "actionGroup": {
        "0": {
          "action": "ExecuteScript",
          "params": {
            "script": "const apiKey = await ctx.getValue(\"apiKey\"); await ctx.getExt(\"SecureStorage\").write(\"apiKey\", apiKey); const calendarId = await ctx.getValue(\"calendarId\"); await ctx.getExt(\"SecureStorage\").write(\"calendarId\", calendarId); const pinCode = await ctx.getValue(\"pinCode\"); if (!!pinCode) { await ctx.getExt(\"SecureStorage\").write(\"pinCode\", pinCode); } ctx.getRouter().navigate(\"dashboard\");"
          }
        }
      }
    },    
    "65e17411-c15c-48f1-b1c5-dff402b23d11": {
      "id": "65e17411-c15c-48f1-b1c5-dff402b23d11",
      "props": {
        "_x_name": "65e17411-c15c-48f1-b1c5-dff402b23d11",
        "isJustOnce": true
      },
      "children": [],
      "type": "Automatic Action",
      "parent": "root",
      "rootParentType": "Automatic Action",
      "rules": {},
      "actionGroup": {
        "0": {
          "action": "ExecuteScript",
          "params": {
            "script": "const apiKey = await ctx.getExt(\"SecureStorage\").read(\"apiKey\"); const calendarId = await ctx.getExt(\"SecureStorage\").read(\"calendarId\"); await ctx.setValue(\"apiKey\", apiKey); await ctx.setValue(\"calendarId\", calendarId);"
          }
        }
      }
    },     
    "61e5b71f-8f10-413f-9d45-e19cc22c57f3": {
      "id": "61e5b71f-8f10-413f-9d45-e19cc22c57f3",
      "props": {
        "_x_name": "apiKey",
        "_x_onchange": "DefaultValueChange",
        "backgroundColor": "whiteAlpha.500",
        "placeholder": "API Key"
      },
      "children": [],
      "type": "Input",
      "parent": "root",
      "rootParentType": "Input",
      "rules": {},
      "actionGroup": {}
    },
    "d48ef28b-380a-4c38-a77c-38e2621b5237": {
      "id": "d48ef28b-380a-4c38-a77c-38e2621b5237",
      "props": {
        "_x_name": "calendarId",
        "_x_onchange": "DefaultValueChange",
        "backgroundColor": "whiteAlpha.500",
        "placeholder": "Google Calendar Id"
      },
      "children": [],
      "type": "Input",
      "parent": "root",
      "rootParentType": "Input",
      "rules": {},
      "actionGroup": {}
    },
    "39ca73f9-b84a-4082-98fe-2b5c1e17c1ac": {
      "id": "39ca73f9-b84a-4082-98fe-2b5c1e17c1ac",
      "props": {
        "_x_name": "pinCode",
        "_x_onchange": "DefaultValueChange",
        "backgroundColor": "whiteAlpha.500",
        "placeholder": "Setting Page Access Code"
      },
      "children": [],
      "type": "Input",
      "parent": "root",
      "rootParentType": "Input",
      "rules": {},
      "actionGroup": {}
    }                
  },  
  "dashboard": {
    "root": {
      "id": "root",
      "parent": "root",
      "type": "Box",
      "children": [
        "cb0ce3a1-c389-4d43-8460-de469eb31df5",
        "106c893a-6465-4772-a525-994c37dd8628"
      ],
      "props": {},
      "rules": {},
      "actionGroup": {}
    },
    "106c893a-6465-4772-a525-994c37dd8628": {
      "id": "106c893a-6465-4772-a525-994c37dd8628",
      "props": {
        "_x_name": "106c893a-6465-4772-a525-994c37dd8628",
        "seconds": "30"
      },
      "children": [],
      "type": "Automatic Action",
      "parent": "root",
      "rootParentType": "Automatic Action",
      "rules": {},
      "actionGroup": {
        "0": {
          "action": "ExecuteScript",
          "params": {
            "script": "const startOfDay = new Date(); startOfDay.setHours(0); startOfDay.setMinutes(0); startOfDay.setSeconds(0); return { \"startOfDay\": startOfDay.toISOString() }"
          }
        }, 
        "1": {
          "action": "ExecuteScript",
          "params": {
            "script": "const endOfDay = new Date(); endOfDay.setHours(23); endOfDay.setMinutes(59); endOfDay.setSeconds(59); return { \"endOfDay\": endOfDay.toISOString(), ...ctx.getInput() }"
          }
        },         
        "2": {
          "action": "ExecuteScript",
          "params": {
            "script": "const apiKey = await ctx.getExt(\"SecureStorage\").read(\"apiKey\"); const calendarId = await ctx.getExt(\"SecureStorage\").read(\"calendarId\"); return { \"apiKey\": apiKey, \"calendarId\": calendarId, ...ctx.getInput() }"
          }
        },        
        "3": {
          "action": "Fetch",
          "params": {
            "url": "https://www.googleapis.com/calendar/v3/calendars/${calendarId}/events?key=${apiKey}&timeMin=${startOfDay}&timeMax=${endOfDay}"
          }
        },
        "4": {
          "action": "ExecuteScript",
          "params": {
            "script": "const items = ctx.getInput().items; let isBusy = false; let isBusyShortly = false; const result = []; for (let i=0; i<items.length; i++) { const item = items[i]; result.push({ id: item.id, start: item.start.dateTime, end: item.end.dateTime }); isBusy = isBusy || ctx.getExt(\"DateUtil\").isNowBetween(item.start.dateTime, item.end.dateTime); isBusyShortly = isBusyShortly || ctx.getExt(\"DateUtil\").isNowPlusMinBetween(item.start.dateTime, item.end.dateTime, 30); } if (true === isBusy) { await ctx.setPropValue(\"cb0ce3a1-c389-4d43-8460-de469eb31df5\", \"backgroundImage\", \"https://getlibreforge.github.io/demo_files/tablet_image_occupied.png\"); } else if (true === isBusyShortly) { await ctx.setPropValue(\"cb0ce3a1-c389-4d43-8460-de469eb31df5\", \"backgroundImage\", \"https://getlibreforge.github.io/demo_files/tablet_image_soon.png\"); } else { await ctx.setPropValue(\"cb0ce3a1-c389-4d43-8460-de469eb31df5\", \"backgroundImage\", \"https://getlibreforge.github.io/demo_files/tablet_image_vacant.png\"); } return { \"events\": result }"
          }
        },
        "5": {
          "action": "StoreDataAction",
          "params": {
            "stateType": "page"
          }
        }
      }
    },
    "cb0ce3a1-c389-4d43-8460-de469eb31df5": {
      "id": "cb0ce3a1-c389-4d43-8460-de469eb31df5",
      "props": {
        "_x_name": "cb0ce3a1-c389-4d43-8460-de469eb31df5",
        "backgroundColor": "white",
        "backgroundImage": "https://getlibreforge.github.io/demo_files/tablet_image_vacant.png",
        "w": "100%",
        "h": "100vh",
        "backgroundRepeat": "no-repeat",
        "backgroundSize": "cover"
      },
      "children": [
        "14a3a490-0acb-4232-903e-e294c7fbab77"
      ],
      "type": "Container",
      "parent": "81d52c95-6870-412f-8188-1a328fac5bbd",
      "rootParentType": "Container",
      "rules": {},
      "actionGroup": {}
    },    
    "14a3a490-0acb-4232-903e-e294c7fbab77": {
      "id": "14a3a490-0acb-4232-903e-e294c7fbab77",
      "props": {
        "_x_name": "14a3a490-0acb-4232-903e-e294c7fbab77",
        "children": "Go To Settings",
        "variant": "solid",
        "size": "md",
        "colorScheme": "messenger",
        "backgroundColor": "blue"
      },
      "children": [],
      "type": "Button",
      "parent": "root",
      "rootParentType": "Button",
      "rules": {},
      "actionGroup": {
        "0": {
          "action": "RNRouteToPage",
          "params": {
            "url": "/login"
          }
        }
      }
    }                       
  },
  "login": {
    "root": {
      "id": "root",
      "parent": "root",
      "type": "Box",
      "children": [
        "32f225c6-1914-400c-91ab-c53d56a9b0e0",
        "d29a1e67-44a2-4122-8158-60951e8b756e",
        "3570cc56-6e64-4f84-ba6a-e4bff2d85243"
      ],
      "props": {},
      "rules": {},
      "actionGroup": {}
    },
    "3570cc56-6e64-4f84-ba6a-e4bff2d85243": {
      "id": "3570cc56-6e64-4f84-ba6a-e4bff2d85243",
      "props": {
        "_x_name": "3570cc56-6e64-4f84-ba6a-e4bff2d85243",
        "children": "Back",
        "variant": "solid",
        "size": "md",
        "colorScheme": "messenger",
        "backgroundColor": "black"
      },
      "children": [],
      "type": "Button",
      "parent": "root",
      "rootParentType": "Button",
      "rules": {},
      "actionGroup": {
        "0": {
          "action": "RNRouteToPage",
          "params": {
            "url": "/dashboard"
          }
        }
      }
    },     
    "d29a1e67-44a2-4122-8158-60951e8b756e": {
      "id": "d29a1e67-44a2-4122-8158-60951e8b756e",
      "props": {
        "_x_name": "d29a1e67-44a2-4122-8158-60951e8b756e",
        "children": "Login",
        "variant": "solid",
        "size": "md",
        "backgroundColor": "green",
        "color": "white",
        "w": "50%"
      },
      "children": [],
      "type": "Button",
      "parent": "root",
      "rootParentType": "Button",
      "rules": {},
      "actionGroup": {
        "0": {
          "action": "ExecuteScript",
          "params": {
            "script": "const credentials = await ctx.getValue(\"credentials\"); await ctx.setValue(\"credentials\", undefined); const pinCode = await ctx.getExt(\"SecureStorage\").read(\"pinCode\"); if (!!pinCode && pinCode === credentials) { ctx.getRouter().navigate(\"settings\"); } else { alert(\"Invalid Credentials\"); } "
          }
        }
      }
    },        
    "32f225c6-1914-400c-91ab-c53d56a9b0e0": {
      "id": "32f225c6-1914-400c-91ab-c53d56a9b0e0",
      "props": {
        "_x_name": "credentials",
        "_x_onchange": "DefaultValueChange",
        "backgroundColor": "whiteAlpha.500",
        "placeholder": "PIN code"
      },
      "children": [],
      "type": "Input",
      "parent": "root",
      "rootParentType": "Input",
      "rules": {},
      "actionGroup": {}
    }        
  }    
}
